{% comment %} {% extends 'base.html' %} {% endcomment %}
{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>브롤스타즈 MBTI 테스트</title>
  <link rel="icon" href="{% static 'images/favicon.png' %}">
  <link rel="stylesheet" href="{% static 'css/base.css' %}">
  <link rel="stylesheet" href="{% static 'css/question.css' %}">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-GLhlTQ8iRABdZLl6O3oVMWSktQOp6b7In1Zl3/Jr59b6EGGoI1aFkw7cmDA6j6gD" crossorigin="anonymous">
  <link rel="stylesheet" href="{% static 'css/question.css' %}">
</head>
  
<body>
  <div class="wrapper">
    <div id="main" class="mobile-display main container text-center">
      <h1 id="question-tag" class="mb-4">Question <span id="question_no">{{question.pk}}</span> / 12</h1>
      <h2 id="question">{{ question.question }}</h2>
      <div class="my-4">
        {% comment %} <img id="question-img" src="{% static 'images/favicon.png' %}" alt="" style="width:30%;"> {% endcomment %}
      </div>
      <button type="button" id="answer1" class="answer my-2" data-pk="{{question.pk}}" data-letter="{{question.answer1_letter}}" data-mbti="{{mbti}}">{{question.answer1}}</button>
      <button type="button" id="answer2" class="answer my-2" data-pk="{{question.pk}}" data-letter="{{question.answer2_letter}}" data-mbti="{{mbti}}">{{question.answer2}}</button>
    </div>
    <div id="loader" class="mobile-display container" style="display:none;">
      <img src="{% static '/images/brawl_loading.gif' %}" alt="loading_gif" style="width:60%;">
      <h4 class="my-5" style="color:white;">어울리는 브롤러를 찾는 중이에요...</h4>
    </div>
  </div>
</body>

<script src="https://code.jquery.com/jquery-3.6.3.min.js" integrity="sha256-pvPw+upLPUjgMXY0G+8O0xUf+/Im1MZjXxxgOcBQBXU=" crossorigin="anonymous"></script>
<script>
  $('.answer').click(function(event){
    var chosenId = event.target.id
    var pk = $(`#${chosenId}`).data('pk')
    var letter = $(`#${chosenId}`).data('letter')
    var mbti = $(`#${chosenId}`).data('mbti')

    $.ajax({
      url: '/ajax/',
      dataType: "json",
      type: "POST",
      data: {
        'pk': pk,
        'letter': letter,
        'mbti': mbti
      },
      success: function (data) {
        console.log('success')
        $('#question_no').text(data['question_pk'])
        $('#question').text(data['question'])
        //$('#question-img').attr('src', '{% static 'images/welcome.jpg' %}')
        $('#answer1').text(data['question_ans1'])
        $('#answer1').data('pk', data['question_pk'])
        $('#answer1').data('letter', data['question_letter1'])
        $('#answer1').data('mbti', data['mbti'])
        $('#answer2').text(data['question_ans2'])
        $('#answer2').data('pk', data['question_pk'])
        $('#answer2').data('letter', data['question_letter2'])
        $('#answer2').data('mbti', data['mbti'])
      },
      error: function (request, status, error) {
        console.log('finished')
        $("#main").css('display', 'none')
        $("#loader").css('display', 'block')
        mbti += letter
        setTimeout(() => {
          window.location.href = `/result/${mbti}`
        }, 3500)
        }
      });
    })
  </script>
</html>
{% comment %} <script src="{% static '/js/question.js' %}"></script> {% endcomment %}
