{% comment %} {% extends 'base.html' %} {% endcomment %}
{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>브롤스타즈 MBTI 테스트</title>
  <link rel="icon" href="{% static 'images/favicon.png' %}">
  <link rel="stylesheet" href="{% static 'css/base.css' %}">
  <link rel="stylesheet" href="{% static 'css/question.css' %}">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-GLhlTQ8iRABdZLl6O3oVMWSktQOp6b7In1Zl3/Jr59b6EGGoI1aFkw7cmDA6j6gD" crossorigin="anonymous">
</head>
  
<body>
  {% block content %}
    <link rel="stylesheet" href="{% static 'css/question.css' %}">
    <div class="container my-5">
      <div class="d-flex row text-center justify-content-center">
        <h2 id="question" class="my-3">{{ question.question }}</h2>
        <div class="my-3">
          <img src="{% static 'images/favicon.png' %}" alt="" style="width:30%;">
        </div>
        <button type="button" id="answer1" class="answer my-3" data-pk="{{question.pk}}" data-letter="{{question.answer1_letter}}" data-mbti="{{mbti}}">{{question.answer1}}</button>
        <button type="button" id="answer2" class="answer my-3" data-pk="{{question.pk}}" data-letter="{{question.answer2_letter}}" data-mbti="{{mbti}}">{{question.answer2}}</button>
      </div>
    </div>
  {% endblock content %}
</body>

<script src="https://code.jquery.com/jquery-3.6.3.min.js" integrity="sha256-pvPw+upLPUjgMXY0G+8O0xUf+/Im1MZjXxxgOcBQBXU=" crossorigin="anonymous"></script>
<script>
  $('.answer').click(function(event){
    var chosenId = event.target.id
    var pk = $(`#${chosenId}`).data('pk')
    var letter = $(`#${chosenId}`).data('letter')
    var mbti = $(`#${chosenId}`).data('mbti')

    $.ajax({
      url: '/ajax/',
      dataType: "json",
      type: "POST",
      data: {
        'pk': pk,
        'letter': letter,
        'mbti': mbti
      },
      success: function (data) {
        console.log('success')
        $('#question').text(data['question'])
        $('#answer1').text(data['question_ans1'])
        $('#answer1').data('pk', data['question_pk'])
        $('#answer1').data('letter', data['question_letter1'])
        $('#answer1').data('mbti', data['mbti'])
        $('#answer2').text(data['question_ans2'])
        $('#answer2').data('pk', data['question_pk'])
        $('#answer2').data('letter', data['question_letter2'])
        $('#answer2').data('mbti', data['mbti'])
      },
      error: function (request, status, error) {
        console.log('finished')
        //$("div.main").css('display', 'none')
        //$("div.loader").css('display', 'block')
        mbti += letter
        /* setTimeout(() => {
          window.location.href = `/result/${mbti}`
        }, 3500) */
        }
      });
    })
  </script>
</html>
{% comment %} <script src="{% static '/js/question.js' %}"></script> {% endcomment %}
